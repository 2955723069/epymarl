# 动态选择run模块实现计划

## 问题分析

当前EPyMARL框架中，`main.py`固定从`run.py`导入`run`函数，无法根据算法配置动态选择不同的运行模块。用户希望运行group算法时使用`interval_run.py`，而其他算法继续使用默认的`run.py`。

## 解决方案

修改`main.py`文件，实现根据算法配置动态选择要导入和使用的`run`函数。

## 实现步骤

1. **修改main.py文件**

   * 删除第20行的固定导入语句`from run import run`

   * 修改`my_main`函数，在函数内部根据配置动态导入`run`函数

   * 添加动态导入逻辑：如果`alg_config`中有`run`配置项，就导入对应的模块，否则使用默认的`run.py`

2. **关键代码修改**

   ```python
   @ex.main
   def my_main(_run, _config, _log):
       # Setting the random seed throughout the modules
       config = config_copy(_config)
       np.random.seed(config["seed"])
       th.manual_seed(config["seed"])
       config["env_args"]["seed"] = config["seed"]
       
       # 动态导入run函数
       run_module = config.get("run", "run")
       if run_module == "interval_run":
           from interval_run import run
       else:
           from run import run
       
       # run the framework
       run(_run, config, _log)
   ```

## 预期效果

* 当运行group算法时，由于`group.yaml`中配置了`run: "interval_run"`，会导入并使用`interval_run.py`中的`run`函数

* 当运行其他算法时，由于没有`run`配置项或配置项为默认值，会导入并使用`run.py`中的`run`函数

* 其他算法不受影响，只有group算法使用特殊的运行逻辑

## 验证方法

1. 运行group算法：`python src/main.py --config=group --env-config=sc2 with env_args.map_name=3s5z_vs_3s6z`
2. 运行其他算法：`python src/main.py --config=qmix --env-config=sc2 with env_args.map_name=3s5z`
3. 检查日志输出，确认group算法使用了interval\_run.py的运行逻辑

## 注意事项

* 确保`interval_run.py`与`run.py`具有相同的`run`函数接口，包括参数列表和返回值

* 动态导入逻辑应放在`my_main`函数内部，以确保在配置加载完成后执行

